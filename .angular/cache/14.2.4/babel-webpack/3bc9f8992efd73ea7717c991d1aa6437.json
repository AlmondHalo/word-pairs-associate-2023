{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.formatSort = void 0;\n\nconst error_1 = require(\"./error\");\n/** @internal */\n\n\nfunction prepareDirection(direction = 1) {\n  const value = `${direction}`.toLowerCase();\n  if (isMeta(direction)) return direction;\n\n  switch (value) {\n    case 'ascending':\n    case 'asc':\n    case '1':\n      return 1;\n\n    case 'descending':\n    case 'desc':\n    case '-1':\n      return -1;\n\n    default:\n      throw new error_1.MongoInvalidArgumentError(`Invalid sort direction: ${JSON.stringify(direction)}`);\n  }\n}\n/** @internal */\n\n\nfunction isMeta(t) {\n  return typeof t === 'object' && t != null && '$meta' in t && typeof t.$meta === 'string';\n}\n/** @internal */\n\n\nfunction isPair(t) {\n  if (Array.isArray(t) && t.length === 2) {\n    try {\n      prepareDirection(t[1]);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  return false;\n}\n\nfunction isDeep(t) {\n  return Array.isArray(t) && Array.isArray(t[0]);\n}\n\nfunction isMap(t) {\n  return t instanceof Map && t.size > 0;\n}\n/** @internal */\n\n\nfunction pairToMap(v) {\n  return new Map([[`${v[0]}`, prepareDirection([v[1]])]]);\n}\n/** @internal */\n\n\nfunction deepToMap(t) {\n  const sortEntries = t.map(([k, v]) => [`${k}`, prepareDirection(v)]);\n  return new Map(sortEntries);\n}\n/** @internal */\n\n\nfunction stringsToMap(t) {\n  const sortEntries = t.map(key => [`${key}`, 1]);\n  return new Map(sortEntries);\n}\n/** @internal */\n\n\nfunction objectToMap(t) {\n  const sortEntries = Object.entries(t).map(([k, v]) => [`${k}`, prepareDirection(v)]);\n  return new Map(sortEntries);\n}\n/** @internal */\n\n\nfunction mapToMap(t) {\n  const sortEntries = Array.from(t).map(([k, v]) => [`${k}`, prepareDirection(v)]);\n  return new Map(sortEntries);\n}\n/** converts a Sort type into a type that is valid for the server (SortForCmd) */\n\n\nfunction formatSort(sort, direction) {\n  if (sort == null) return undefined;\n  if (typeof sort === 'string') return new Map([[sort, prepareDirection(direction)]]);\n\n  if (typeof sort !== 'object') {\n    throw new error_1.MongoInvalidArgumentError(`Invalid sort format: ${JSON.stringify(sort)} Sort must be a valid object`);\n  }\n\n  if (!Array.isArray(sort)) {\n    return isMap(sort) ? mapToMap(sort) : Object.keys(sort).length ? objectToMap(sort) : undefined;\n  }\n\n  if (!sort.length) return undefined;\n  if (isDeep(sort)) return deepToMap(sort);\n  if (isPair(sort)) return pairToMap(sort);\n  return stringsToMap(sort);\n}\n\nexports.formatSort = formatSort;","map":{"version":3,"names":["Object","defineProperty","exports","value","formatSort","error_1","require","prepareDirection","direction","toLowerCase","isMeta","MongoInvalidArgumentError","JSON","stringify","t","$meta","isPair","Array","isArray","length","e","isDeep","isMap","Map","size","pairToMap","v","deepToMap","sortEntries","map","k","stringsToMap","key","objectToMap","entries","mapToMap","from","sort","undefined","keys"],"sources":["/Users/yoannesfigueiras/node_modules/mongodb/lib/sort.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatSort = void 0;\nconst error_1 = require(\"./error\");\n/** @internal */\nfunction prepareDirection(direction = 1) {\n    const value = `${direction}`.toLowerCase();\n    if (isMeta(direction))\n        return direction;\n    switch (value) {\n        case 'ascending':\n        case 'asc':\n        case '1':\n            return 1;\n        case 'descending':\n        case 'desc':\n        case '-1':\n            return -1;\n        default:\n            throw new error_1.MongoInvalidArgumentError(`Invalid sort direction: ${JSON.stringify(direction)}`);\n    }\n}\n/** @internal */\nfunction isMeta(t) {\n    return typeof t === 'object' && t != null && '$meta' in t && typeof t.$meta === 'string';\n}\n/** @internal */\nfunction isPair(t) {\n    if (Array.isArray(t) && t.length === 2) {\n        try {\n            prepareDirection(t[1]);\n            return true;\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    return false;\n}\nfunction isDeep(t) {\n    return Array.isArray(t) && Array.isArray(t[0]);\n}\nfunction isMap(t) {\n    return t instanceof Map && t.size > 0;\n}\n/** @internal */\nfunction pairToMap(v) {\n    return new Map([[`${v[0]}`, prepareDirection([v[1]])]]);\n}\n/** @internal */\nfunction deepToMap(t) {\n    const sortEntries = t.map(([k, v]) => [`${k}`, prepareDirection(v)]);\n    return new Map(sortEntries);\n}\n/** @internal */\nfunction stringsToMap(t) {\n    const sortEntries = t.map(key => [`${key}`, 1]);\n    return new Map(sortEntries);\n}\n/** @internal */\nfunction objectToMap(t) {\n    const sortEntries = Object.entries(t).map(([k, v]) => [\n        `${k}`,\n        prepareDirection(v)\n    ]);\n    return new Map(sortEntries);\n}\n/** @internal */\nfunction mapToMap(t) {\n    const sortEntries = Array.from(t).map(([k, v]) => [\n        `${k}`,\n        prepareDirection(v)\n    ]);\n    return new Map(sortEntries);\n}\n/** converts a Sort type into a type that is valid for the server (SortForCmd) */\nfunction formatSort(sort, direction) {\n    if (sort == null)\n        return undefined;\n    if (typeof sort === 'string')\n        return new Map([[sort, prepareDirection(direction)]]);\n    if (typeof sort !== 'object') {\n        throw new error_1.MongoInvalidArgumentError(`Invalid sort format: ${JSON.stringify(sort)} Sort must be a valid object`);\n    }\n    if (!Array.isArray(sort)) {\n        return isMap(sort) ? mapToMap(sort) : Object.keys(sort).length ? objectToMap(sort) : undefined;\n    }\n    if (!sort.length)\n        return undefined;\n    if (isDeep(sort))\n        return deepToMap(sort);\n    if (isPair(sort))\n        return pairToMap(sort);\n    return stringsToMap(sort);\n}\nexports.formatSort = formatSort;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}